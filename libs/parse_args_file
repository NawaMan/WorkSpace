#!/usr/bin/env bash
# Print sanitized tokens from an args file, preserving quoting.
# Usage: parse_args_file <path>
set -euo pipefail

f="${1:-}"
[[ -z "$f" || "$f" == "none" ]] && exit 0
[[ ! -f "$f" ]] && { echo "Error: '$f' is not a file" >&2; exit 1; }

# Normalize CRLF and skip blanks/comments; echo each line as-is
# so the caller can do: eval 'ARRAY+=('<line>')'
while IFS= read -r line || [[ -n "$line" ]]; do
  [[ "$line" =~ ^[[:space:]]*$ ]] && continue
  [[ "$line" =~ ^[[:space:]]*# ]] && continue
  echo "$line"
done < <(sed $'s/\r$//' "$f")
